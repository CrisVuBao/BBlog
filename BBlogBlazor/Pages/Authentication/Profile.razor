@page "/profile";
@inject AuthenticationStateProvider authenticationStateProvider;
@using BBlogBlazor.Component
@using BBlogBlazor.Static
@using Microsoft.AspNetCore.Components.Authorization;

@if (PostForUser == null)
{
    <LoadingBar></LoadingBar>
}
else
{
    <div class="profile-layout">
        <div class="profile-info">
            <!--Banner-->
            <div class="banner-tech card text-white">
                <div class="card-img-overlay">
                    <div class="profile">
                        <div class="d-flex justify-content-center">
                            <img src="./images/avatar/admin.webp" class="image-avt rounded-circle"
                                 width="120" alt="Avatar" loading="lazy" />
                        </div>
                        <div class="d-flex justify-content-center">
                            <h5 class="card-title fw-bold text-dark">Thông tin người dùng</h5>
                        </div>
                        <AuthorizeView>
                            <div class="d-flex justify-content-center">
                                <h5 class="card-title fw-bold text-dark">@context.User.Identity.Name</h5>
                            </div>
                        </AuthorizeView>
                    </div>
                </div>
            </div>
        </div>
        <div class="my-post-layout">
            <div class="my-post container">
                <div class="title-my-post">
                    <h5>Bài Viết Của Bạn</h5>
                </div>
                <div class="post-list">
                    <!--Danh sách tin tức và bài viết-->
                    <div class="list-news mt-3">
                        @foreach (var listNews in PostForUser)
                        {
                            <div class="post-user mb-3 mt-3" style="max-width: 100%; height: 150px;">
                                <div class="row g-0">
                                    <div class="layout-list-news col-md-4">
                                        <a href="/blog-detail/@listNews.PostId"><img src="@($"{APIEndpoints.ServerBaseUrl}/{listNews.PicturePostUrl}")" class="img-list-news img-fluid" accept="image/jpeg, image/png, image/jpg, image/webp" alt="..."></a>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="" style="padding: 0 16px 16px 16px;">
                                            <a href="/blog-detail/@listNews.PostId" class="text-decoration-none"><h5 class="card-title text-black">@listNews.Title</h5></a>
                                            <div class="">@listNews.BriefContent</div>
                                            <div class="d-flex">
                                                <p class="me-3"><small class="h6" style="color: #6C5F5B;">Tạo Bài Vào: @listNews.CreateDate</small></p>
                                                <span class="text-muted">Số lượt xem: @listNews.ViewCount</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="btn-post">
                                <a class="btn btn-primary px-3" href="update-post/@listNews.PostId">
                                    <i class="fa-solid fa-pen-to-square"></i>
                                    Chỉnh sửa bài viết
                                </a>
                                <button class="btn btn-danger" @onclick="(() => HandleDeletePost(listNews.PostId.ToString()))">
                                    <i class="fas fa-times"></i>
                                    Xóa bài viết
                                </button>
                            </div>
                        }
                    </div>
                    <!--Danh sách tin tức và bài viết end-->
                </div>
            </div>
        </div>
    </div>
}
